<!DOCTYPE html>

<html lang="da">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noindex">
        <style>
            .retterne {
                border: 1px solid black;
                margin-bottom: 10px;
            }

            img {
                width: 100%;
                height: auto;
            }
            
            main {
            display: grid;
            grid-template-columns: 1fr minmax(0, 1300px) 1fr;
            }

            section {
            grid-column: 2/3;
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px;
            max-width: 1200px;
            align-items: center;
            justify-items: center;
            }

            header {
                grid-column: 2/3;
            }

            .valgt {
                background-color:red;
            }

            #top {
                background-color: orange;
                height: 250px;
                display: flex;
                justify-content: center;
                align-items: center;
            }
            
            nav {
                padding-top: 20px;
                gap: 20px;
                grid-column: 2/3;
            }

            footer {
                background-color: grey;
                height: 100%;
                display: flex;
                justify-content:space-evenly;
            }

        </style>
    </head>

    

<!-- BODY  -->
<body>

    <div id="top">
        <h1> BISTRO BABUSHKA</h1>
    </div>

    <main>
    <nav>
        <button data-kategori="alle" class="valgt"> Alle </button>
        <button data-kategori="drikkevarer"> drikkevarer </button>
        <button data-kategori="forretter"> forretter </button>
        <button data-kategori="hovedretter"> hovedretter </button>
        <button data-kategori="desserter"> desserter </button>
        <button data-kategori="sideorders"> sideorders </button>
    </nav>


    <header>
        <h1> Alle </h1>
    </header>

    <!-- Data containeren bruges som den tomme skal, som alt fram template bliver klonet op i med ny data fra json filen -->
    <section class="data-container"></section>
    <template>
        <article class="retterne">
            <img src="" alt="" class="billede">
            <h2 class=navn></h2>
            <p class="kortbeskrivelse"></p>
            <p class="pris"></p>
        </article>
    </template>

    </main>

    <footer>
        <div class="f1">
            <h3>Bistro Babushka</h3>
            <p>Adresse: Øresundsvej 94 <br>
            2300 København S <br>
            CVR: 1234592 </p>
        </div>

        <div class="f2">
            <h3>Åbningstider</h3>
            <p>Man - tors: 10.00 - 16.00<br>
            Fredag: 10.00 - 20.00 <br>
            Lør & Søn: 10.00 - 21.00 </p>
        </div>
    </footer>
</body>

<!-- SCRIPT -->
<script>

    // Eventlister som lytter på om al DOM er loaded, og som starter fuctionen 'start'
    window.addEventListener("DOMContentLoaded", start);
    console.log("DOM fully loaded");

    // Laver en constant, der targeter data-containeren i html'en, hvor alt data bliver kopieret op til //
    const container = document.querySelector(".data-container");
    // Al data inde i templater, er skabelonen for hvordan tingene kommer til at se ud i data-containeren //
    const menuTemplate = document.querySelector("template"); 
    // Oprettes en constant (jsonData), som linker til jsondatabasen //
    const jsonData = "https://babushka-dd8a.restdb.io/rest/menu";
    // Oprettes en constant (options), som tilføjet api nøgen til databasen i json //
    const options = {headers: {"x-apikey": "600ec2fb1346a1524ff12de4",},};
    // Oprettes en constant, som linker til h1 i headeren i HTML //
    const header = document.querySelector("header h1");
    // Oprettes en tom constant, fordi så har jeg en generel som gælder i alle functions nedenfor i scriptet //
    let retter;

    // Oprettes en variabel (Filder), som skriver tekste "alle"(Er i tvivl om denne) //
    let filter = "alle";
    
    // Functionen 'start' sættes igang
    function start () {
        // Oprettest en constant (filterKnapper), som linker til button i nav i HTML //
        const filterKnapper = document.querySelectorAll("nav button");
        // For hver knap der er i constanten filderKnapper, lytter den efter "click" og starter derefter fuctionen filtrerRetter //
        filterKnapper.forEach (knap => knap.addEventListener("click", filtrerRetter));
        // Her henter scriptet data ind fra JSON filen //
        hentdata();
    }

    // Her starter functionen filtrerePersoner //
    function filtrerRetter() {
        // Her defineres variablen 'filter', som får indholdet fra (this = den knap der er trykket på) jf. datasættet.troende i HTML'en //
        filter = this.dataset.kategori; 
        // Her fjernes classen .valgt fra den givende knap der er trykket på //
        document.querySelector(".valgt").classList.remove("valgt");
        // Her tilføjes classen valgt til den givende knap der er trykket på //
        this.classList.add("valgt");
        // Her vises personerne på ny med det ovenstående filder, der er tilføjet ved tryk på knappen //
        visRetter();
        // Her ændres textContent i constanten 'header' til indholdet, af den knap som der er trykket på //
        header.textContent = this.textContent;
    }
        
    // Sitet synkroniserer med data fra json database
        // Her hentes data fra json 
        async function hentdata() {
        // Her oprettes constanten 'result', som består af fetch af jsonData(link til database) & options(api key) //    
        const result = await fetch(jsonData, options);
        // Her giver vi gobal-variablen 'personer' en egenskab, hvor den afventer constaten 'result' //
        retter = await result.json();
        // Her consol-logger jeg variablen personer (er oprettet globalt, men som har fået værdi her i denne fuction) //
        console.log(retter);
        // Her vises personerne fra json databasen //
        visRetter();
        }

    // Functionen kører hver datapoint gennem fra json og opretter en klon med nedestående parametre. //
    function visRetter() {
        // Teksten i global-constaten 'container' fjernes //
        container.textContent = "";  
        // Her kørrest arrayet (listen fra json) igennem, hvor for hver person der er på listen, så sker følgende: //
        retter.forEach(ret => {
            // En if fuction, hvor den følger feltet 'troende' på hver person i json filen og udvælger 'alle' ergo den filterer ikke //
            if (filter == ret.kategori || filter == "alle") {
                // Her opretter vi variablen 'klon', som kloner nedestående content //
                let klon = menuTemplate.cloneNode(true).content;
                // Her targeter vi texten i h2 og gør den = person.fornavn (i json filen) //
                klon.querySelector("h2").textContent = ret.navn;
                // Her targeter vi billedet i html og gør den = faces/ + iden fra person.billede i json filen //
                klon.querySelector("img").src = "bistro_billeder/" + ret.billednavn + "-md.jpg";
                // Her targeter vi texten i h2 og gør den = person.fornavn (i json filen) //
                klon.querySelector(".kortbeskrivelse").textContent = ret.kortbeskrivelse;
                // Her targeter vi classen .hobby og ændre textindholdet til : Teksten "Hobby: " og tilføjer dataen person.hobby fra json filen) //
                klon.querySelector(".pris").textContent ="Pris: " + ret.pris;    
                // Her opretter vi et childelement til i constanten container //
                container.appendChild(klon);
            }
        });
     }
    </script>

</html>